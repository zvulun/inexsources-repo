:docproductname: PTL
:docproductname2: Pelco
:docproductname3: Motorola
//:fileproductname: IZA500G-GR
//:shortprodname: IZIDPUGOX
:generic-camera-name: camera

// set attribute (by uncommenting the line)
// used to determine which text/links to sections
// outside partials - should be used in partials
// see the playbook for full list

:xref-type-PELCO:
:layout-type-userguide:

//related doc links are temporarily pointed
//to GDrive; when the site is live
//change this to :link-type-site not needed
//when save as PDF is done from internet site
//:link-type-gdrive:

//enable the TOC to be placed in a specific position
:toc: macro

= {compname-short} Solution for the {docproductname3} {docproductname} System

+++<font size="+3">+++ *Configuration Guide*+++</font>+++

image::ROOT:SLN-PTL/MOTOROLA_LOGO.png[image,300,align=left]

// restore section numbering from here on
:sectnums: all
{empty}
{empty}

// place the TOC in this specific position (capability enabled by :toc: macro at start
// of file

._Click to show the Table of Contents_
[%collapsible]
====

toc::[]

====

<<<

////

[#s_Related-Documents]

== Related Documents

._Click to show the Related Documents table_
[%collapsible]
====

[#t_Related-Documents]

.Related Documents

[table.withborders,width="100%",cols="51%,49%",options="header",]
|===
|Doc. No. |Title
.^|xref:IZDiscovery:DocList.adoc[{software-discovery} Utility] |{software-discovery} Utility software components

.^|xref:IZDiscovery:DocList.adoc[IZDISCOVERY-MAN-001] |{software-discovery} User Guide

.^|xref:RoadViewALPR:DocList.adoc[{software-ALPR} documentation] |(Depends on version)

.^|xref:EULA:DocList.adoc[EULA-400-DOC-001] |Software End User License Agreement (includes list of open source software)

.^|xref:IZPWR:DocList.adoc[IZPWRDIN-REV-x-TDSHEET] |IZPWR DIN Rail Mount Power Supplies Technical Data Sheet

.^|xref:IZIO:DocList.adoc[{hw-iocontroller}-6060-MAN-001] |{hw-iocontroller} Digital I/O Controller Installation and User Guide

.^|xref:LOOP-DTCR-L:DocList.adoc[{hw-loopdetect-l}-MAN-001] |{hw-loopdetect-l} Loop Detector Installation and User Guide

.^|xref:NDAA:DocList.adoc[NDAA-NB-COC-001] |NDAA Section 889 Certification of Compliance
|===

====

////

== Background
This document describes how to
configure the {compname-short} {docproductname3} {docproductname} system.


== Computer and Software Requirements
* Computer running with Windows 10 or later
* Chrome or Microsoft Edge browser

<<<

== Use {software-discovery}

The factory default IP address of the {hw-advanced-processor}
Data Processing Unit (DPU) is on the sticker on the device;
typically {ip-default-IZA-DPU}. If needed, use {software-discovery} to change its IP address
to one you have allocated in your network.

//+
//* LPR Camera - http://192.168.5.101/ +
//* OV Camera - http://192.168.5.102/ +

include::ROOT:partial$IZDiscovery/p-IZDISCOVERY-To-Include.adoc[leveloffset=+1]

////
[#s_Configure-Microsoft-Edge]

== Configure Microsoft Edge

include::ROOT:partial$p-configure-ms-edge-1.adoc[First part of MS Edge configuration]
+
<<<
image::ROOT:SLN-TIBA/image-TIBA-MSedge-settings-2.png[image,800, align=center]

include::ROOT:partial$p-configure-ms-edge-2.adoc[[Second part of MS Edge configuration]]
////

<<<

== Prepare to Aim and Calibrate

Move a vehicle next to, and at the middle of
the capture line. (This is the position at
which the vehicle detector signals that the
vehicle is present.) Ensure that the camera
is aimed at the middle of the lane, and is at the
required capture distance.

Alternatively, in a lab, position a license plate
at the expected distance and height.

[#s_Using-RoadView]

== Log In to {software-ALPR}

=== Logging In
. Open a browser.

. Type in the IP address of the {software-ALPR} computer - the {hw-advanced-processor}.
For example: +
{ip-default-IZA-DPU}

. You will see the login screen. Enter the default username
and password (root, root):
+
[#f_Logging-In-to-RoadView]

.Logging In to {software-ALPR}

image::ROOT:SLN-TIBA/RV-TIBA-FIG-012_OldLoginNoResetPW.png[image,width=209,height=143]

. You should see the {software-ALPR} Live (Journal) tab
(see <<s_Verify-System-Operation>>).

=== Logging Out (Multi-line Menu Icon)

* Click on the multi-line menu icon at the upper right of the {software-ALPR} screen

* Select "Logout"

[#f_Logout-Multi-line-Menu]

.Logout (Multi-line Menu)

image::RoadViewALPR:UserGuide/image5.png[image,width=136,height=113]

<<<

[#s_Configure-RoadView-Settings-Tab]

== Configure {software-ALPR} - Settings Tab

Use the Settings tab after the first installation or
re-installation of the PTL system, or when some
fundamental parameters need updating.
For example, if the {hw-advanced-processor} was moved
to a different location (time zone).

[NOTE]

========================================
Configure the parameters in the order in this
section of the document.

After clicking the Save button at the end of the
Detector Configuration section, it will take
several seconds before the Live tab
can start displaying Events.
Also, some defaults and/or available
parameters may change, depending on the
Detector Configuration "Mode" selected.
========================================

[#s_Software-Version-and-DPU-Information]

=== Software Version and DPU Information

The box at the upper right of the Settings screen shows:

* The {software-ALPR} software version (verify that the version is correct)

* The model, part number and serial number of the DPU that {software-ALPR} is communicating with:

[#f_Software-Version-and-DPU-Information-Section]

.Software Version and DPU Information Section

image::ROOT:SLN-PTL/RV-PTL-FIG-001_VersionAndCameraInfo.png[image,400]

<<<

[#s_Network-Settings]

=== Network Settings

[#f_Network-Settings-Section]

.Network Settings Section

image::ROOT:SLN-PTL/RV-PTL-FIG-002_Network.png[image,600]

* If needed, set the {hw-advanced-processor} IP address parameters.

* Remember to click the Save button in this section;
the change will be applied immediately.

[IMPORTANT]

========================================

The Network Settings refer to the
+++<u>+++{hw-advanced-processor} computer+++</u>+++
 - NOT the
computer on which the browser displaying the GUI is running.

*+++<u>+++It is highly recommended to use a fixed IP
address (not DHCP)+++</u>+++*. A fixed IP address enables
you to access the DPU using the same URL every time,
even after unexpected power outages.

========================================

<<<

[#s_Date-and-Time-Settings]

=== Date and Time Settings

[IMPORTANT]

========================================

The Date and Time Settings refer to the location of the
+++<u>+++{hw-advanced-processor} computer+++</u>+++
- NOT the
computer on which the browser displaying the GUI is running.

The Time Zone selections are organized by continent.
For example, the "America/" prefix covers various cities
and countries in North America (U.S. and Canada) and South America.

========================================

[#f_Date-and-Time-Settings-Section]

.Date and Time Settings Section

image::ROOT:SLN-PTL/RV-PTL-FIG-003_Date_Time.png[image,600]

// * Set Time (Automatically/Manually)

*Set Time (Automatically/Manually) -
The preferred setting is "Set Time Automatically"*.

* If *Automatic*, the date and time
will be updated from a central NTP (Network Time) server;
the server can be in the cloud or on a local NTP server.
(The default is ntp.ubuntu.com.)

** Enter the NTP server URL

** Select the interval at
which you want {software-ALPR} to poll for the
date and time (selected from the Polling Interval dropdown).

** Click the "Update Now" button to update
the date and time immediately.

** The icon (green check mark or red "x")
indicates if the URL of the NTP server is correct,
and if the connection to it was successful.

* If an NTP server is not available, select  *Manual*.
Click in the *Date and Time* box to display
a calendar/time popup.

* Select a *Time Zone*;
set it to the local time at the location in which the
DPU is installed
(+++<u>+++not+++</u>+++ the UTC default).

* Remember to click the Save button at the
end of this section after making changes.

<<<

[#s_Lanes]

=== Lanes

Use this section to add and configure Lanes.

[#f_Lanes-Section]

.Lanes Section

image::ROOT:SLN-PTL/RV-PTL-FIG-004_Lanes.png[image,800]

* +++<u>+++Edit+++</u>+++ - edit the Lane's parameters

* +++<u>+++Delete+++</u>+++ - delete the Lane
(a warning will be displayed)

* +++<u>+++Trigger+++</u>+++ - send a software trigger
immediately to {software-ALPR}
+
[NOTE]

========================================

Each Lane number must be unique in the overall ALPR system.

The images from all cameras capturing the same physical lane
will be combined into a single Event.

Each "Lane" is actually a virtual Lane. For example,
if you have two cameras capturing the same physical lane,
you will need to create two different "Lanes",
and associate each camera with a different "Lane".

========================================
+
[#f_Add-Edit-Lane-Dialog]

.Add/Edit Lane Dialog

image::ROOT:SLN-PTL/RV-PTL-FIG-004a_EditLaneDialog.png[image,300]

* *ID* (required) - The identification number of
the lane to be captured by the cameras.
This number will appear associated with Events in the Live tab.

* *Name* (required) - The name of the Lane as it will appear
throughout the user interface (GUI).

* *Location* - Select one of the following options:

** *Unknown* - the camera's position relative to vehicles
is unknown.

** *Front* - the camera in this Lane is capturing images
from the front of vehicles

** *Rear* - the camera in this Lane is capturing images
from the rear of vehicles

* *Passageway* - Unused

* *Ignore Opposite Direction* - Unused

<<<

[#s_Cameras]

=== Cameras

[#f_Cameras-Section]

.Cameras Section

image::ROOT:SLN-PTL/RV-PTL-FIG-005_Cameras.png[image,800]

* +++<u>+++Edit+++</u>+++ - edit the camera's parameters
(see <<f_Add-Edit-Camera-Dialog>>)

* +++<u>+++Delete+++</u>+++ - delete the camera
(a warning will be displayed)

* *Camera table headers:* Camera ID, Lane ID, Name, URL,
Type (as configured when the camera was added)

* *Image* - Thumbnail image from a recent camera image
+
[WARNING]

========================================
If you add a camera, or edit a camera's parameters and
click the Save button in this dialog
(even if you did not change the URL),
you may see a warning icon in the Image column.
The reappearance of the image indicates that the
core software has restarted, and Events will resume
being captured and displayed in the Live tab, with the
following changes: +
- The Event ID will continue to increase from the
last Event ID. +
- The history of previous Events for that camera will be cleared
========================================

* *Add Camera* (button at end of Cameras section):
+
[#f_Add-Edit-Camera-Dialog]

.Add/Edit Camera Dialog

image::ROOT:SLN-PTL/RV-PTL-FIG-006_EditCameraDialog.png[image,300]

<<<

** *Lane ID* - The identification number of the
lane being captured by the camera(s).
Select a Lane number you defined (see <<s_Lanes>>).
This number will appear associated with Events in the Live tab.
+
[NOTE]

========================================

The images from all cameras capturing the same physical
lane will be combined into a single Event.

Using the same Lane ID for different cameras
will combine the reads into one Event (see <<s_Lanes>>).
////
You may even be able to improve read accuracy by changing
the *_\{Max/Pinchas: but if zoom doesn't work, how can user do this?
can he do it manually? or maybe he can't?}_* zoom to have one camera
"see" closer than the other one.
////

You can position multiple cameras to be in different positions
for the same lane (front/rear).

========================================

** *Camera ID* - For internal use; should be unique in the
overall ALPR system

** *Name* - Camera name for internal use; should be unique
in the overall ALPR system

// ** *URL* - RTSP or HTTP URL:

//*** RTSP stream URL example: +
//rtsp:// <camera IP address>/cam0_0

** *URL* - RTSP URL

** *Type* - Type of camera (View)

** *Video Recording Enabled* - Check the box to
enable video recording

** *Video Pre Time* - How much time before the Event
to record video; set as shown

** *Video Post Time* - How much time after the Event
to record video; set as shown

////
Number of frames to be included in the set of frames used
to build an Event - +++<u>+++after+++</u>+++ the trigger
occurs.
////

<<<

[#s_Motorola-Integration]

=== {docproductname3} Integration

Enable {docproductname3} Integration and
set the parameters as follows. *Remember to click the Save button at the end of the
Detector Configuration section after making changes.*

[#f_Motorola-Integration-Section]

.{docproductname3} Integration Section

image::ROOT:SLN-PTL/RV-PTL-FIG-007_Motorola_Integration.png[image,550]

* *{docproductname3} URL* - URL of the {docproductname3} server

* *{docproductname3} User Name* - username to access the {docproductname3} server

* *{docproductname3} Password* - password to access the {docproductname3} server

* *Camera Port* - the HTTPS port on which {software-ALPR}
listens for commands from the {docproductname3} server

* *Log Store Days* - how long {docproductname3} logs are stored
in the {software-ALPR} database; also defines how long
Events are stored in the offline queue

* *Keep Alive Interval* - how often {software-ALPR} sends
a Keep Alive message to the {docproductname3} server

* *Offline Enabled* - enables the Offline Queue for
Events sent to the {docproductname3} server; +++<u>+++should
always be enabled+++</u>+++

<<<

[#s_Journal]

=== Journal

[#f_Journal-Settings]

.Journal Settings Section

image::ROOT:SLN-PTL/RV-PTL-FIG-009_Journal_Settings.png[image,500]

* Check the Enabled checkbox

* *Remember to click the Save button at the end of the
Detector Configuration section after making changes.*

[#s_Detector-Configuration]

=== Detector Configuration

* Set the parameters as shown here

* Remember to click the Save button
at the end of this section after
changing these parameters.

[#f_Detector-Configuration-Section]

.Detector Configuration Section

image::ROOT:SLN-PTL/RV-PTL-FIG-010_Detector_Configuration.png[image,400]

Explanations of frequently used parameters:

* *Mode* - Note that parameters may appear or be hidden, depending on the chosen Mode.

** +++<u>+++NonTriggered+++</u>+++ - Events are created and reported by LPR video analytics

* *Region* - Region for which characters on the plate will be recognized. Select from the following options:

** +++<u>+++Israel+++</u>+++

<<<

== {software-ALPR} - System Info Tab

* The software version and DPU information appear as shown here

image::ROOT:SLN-PTL/RV-PTL-FIG-011_SystemInfo.png[image,800]

<<<

[#s_Calibrating-a-Camera-Using-RoadView]

== Calibrating a Camera Using {software-ALPR}

[#f_Calibration-Tab]

.Calibration Tab

image::ROOT:SLN-PTL/RV-PTL-FIG-012_CalibrationTab.png[image,800]

. When you see a vehicle at a typical
capture position on the video, click on the video to pause it.

. It is recommended to use the view called
"Draw image by maintaining aspect ratio (two-headed arrow)".
You select this view by clicking on the right-most button
at the upper left of the
screen: image:RoadViewALPR:UserGuide/image38.png[image,30]

. Select a camera from the dropdown list

. The Frame Width (horizontal) and Frame Height (vertical)
are displayed at the lower left, and are set automatically.

. The Frame Timestamp at the lower left displays the date
and time that the image is being taken/was taken by the camera.

. Aim the camera using the mounting bracket's adjustment
hardware (see <<f_Pan-Tilt-Roll-Angle-Adjustments>>).

.. *Pan*: Adjust the Pan so that the image of the license
plate is in the horizontal middle of the Field of View.

.. *Tilt:* Adjust the Tilt so that the image
of every expected plate position
(depending on the vehicle type, such as passenger cars,
jeeps, trucks, etc.) will be in the middle of the screen
(from top to bottom).

.. *Roll*: Adjust the Roll so the license plate's
image is horizontally straight, parallel to the ground
(not tilted to one side).
+
[#f_Pan-Tilt-Roll-Angle-Adjustments]

.Pan/Tilt/Roll (Angle) Adjustments

image::ROOT:RoadViewALPR/PanTiltRoll.png[image,width=311,height=186]

. When the correct position is achieved, make a preliminary
tightening of the mounting screws.

. Define the Region of Interest (*ROI*) by dragging
on the corners (vertices) of the trapezoidal region.
For optimum recognition accuracy, the ROI should be
large enough to capture the region where plates
could be found in images.
+
[NOTE]

========================================

The following settings for the cameras are saved
separately. For example, you may want a Region of Interest
that is different for each camera.

========================================
+
////
. Use the zoom and focus buttons to adjust
the view of the video until the width of the plate
is within the extent of the vertices, and
its plate image is clear and sharp.
(The surrounding items, such as the vehicle body,
do not need to be as sharp as the plate.)
+
[IMPORTANT]
========================================
There is a delay between a click of a zoom/focus button
and when you see the effect on the screen.
Be sure to wait until you see the change
on the screen before clicking the button again.
Clicking the button multiple times will cause you
to "overshoot" the desired zoom/focus.

As you adjust the zoom and focus,
you may need to reposition the camera in order to
get the image of the plate back to the desired position.
========================================
////

. Define the *Plate Width Min*: Events will only be created
for plate reads whose width is greater than or equal
to this parameter. Enter the desired value
in the *Plate Width Min* text box. +
This parameter can also be configured by dragging the
small circle on the horizontal line on the Calibration tab
(expressed in pixels). +
This parameter can be used to ignore small plate reads.
For example, if the image was taken when a vehicle is too far
away, the characters are too small to be read - even by a human.

. Define the *Plate Width Max*: Events will only be
created for plate reads whose width is less than or
equal to this parameter. Enter
the desired value in the *Plate Width Max* text box. +
This parameter can also be configured by dragging
the large circle on the horizontal line on the
Calibration tab (expressed in pixels). +
This parameter can be used to prevent false reads,
such as large numbers on trucks.

. *Direction (red arrow on video):* Not used

. When you have finished, click the *Save* button.
Wait several seconds for the display to refresh automatically,
which indicates that the {software-ALPR} recognition software
is running again with the updated parameters.

. When the correct position is achieved, make a final
tightening of the mounting hardware.

. Repeat these steps for other cameras.

<<<

[#s_Verify-System-Operation]

== Verify System Operation

* Using a license plate mounted in a lab,
or by driving a vehicle through the lane,
verify that an Event is generated with the
correct plate read, as recorded in the {software-ALPR} Live (Journal)
tab.

.Live (Journal) Tab

image::ROOT:SLN-PTL/RV-PTL-FIG-013_LiveTab.png[image,800]

* Once the lane is active, verify that Events are being generated
for each vehicle passing each camera, and that the recognition
has sufficient accuracy and confidence.

* You can use the Search tab to find Event records stored in the
{software-ALPR} database.

.Search Tab

image::ROOT:SLN-PTL/RV-PTL-FIG-014_SearchTab.png[image,800]

* Click on each thumbnail under the large Event image pane
to see overview and plate images

* To see the video clip used to create the Event, click on the
Video link under the thumbnails

// {Metadata link not mentioned since it has not
//yet been implemented; it should download a text file
//with the event metadata that can be opened with notepad}

<<<

* You can use the System Status tab to check the statuses
of different system components

.System Status Tab

image::ROOT:SLN-PTL/RV-PTL-FIG-015_SystemStatusTab.png[image,400]

<<<

[#s_Troubleshooting]

== {software-ALPR} Troubleshooting

[#t_Troubleshooting]

.{software-ALPR} Troubleshooting

[table.withborders,width="100%",cols="35%,65%",options="header",]
|===
|Symptom |Possible Solution
|Thumbnails in Settings tab, in the Camera section at bottom have been replaced by red exclamation points and/or +
The Live tab and Search tab are empty (no Events are detected) a|
* Verify that each camera's IP address, and the {software-ALPR} computer's IP address are all on the same subnet.

* Verify that stable power at the correct level is being supplied to the cameras, even when under a heavy processing load.

* Verify that the IP address(es) configured in {software-ALPR} match the IP addresses that you configured in the camera(s). See <<s_Cameras>>.

|Recognition rates are low a|
* On the Calibration tab, increase the size of the Region of Interest (ROI) - it may be too small to capture plates with high confidence

* On the Calibration tab, try to reduce the Plate Width Min and increase the Plate Width Max

Examine the video from the Camera on the Calibration tab:

* If all license plates are not fully visible, re-aim the camera so that the each camera's field of view fully covers the capture zone. For a more precise adjustment, verify that the license plate's images are as close to the middle of the video display as possible.

* If the images are spotted, remove dirt and dust from the front window of the camera with a soft cloth and mild soap

//* If the images are not sharp, adjust the zoom and focus of each camera.

|===

<<<

== Legal Notices

include::ROOT:partial$p-front-matter-notice.adoc[Front Matter Notice]

include::ROOT:partial$p-software-precautions.adoc[ALPR Camera Safety Precautions]

+++<div class="pagebreak"> </div>+++

include::ROOT:partial$p-legal-disclaimer.adoc[Legal Disclaimer]

include::ROOT:partial$p-footer-copyright-short.adoc[Short Copyright Notice]

Doc. No. {docproductname}-MAN-002b Ver. {docdate}
